{"version":3,"sources":["../../src/BaseChart/index.js"],"names":["iconSize","downloadPath","resetPath","lockPath","unlockPath","actionButtons","download","title","path","className","reset","xlock","ylock","axisType","scaleType","cat","d3","scaleBand","timeCat","time","scaleTime","linear","scaleLinear","log","scaleLog","sqrt","scaleSqrt","pow","scalePow","quantize","scaleQuantize","quantile","scaleQuantile","identity","scaleIdentity","timeFormat","formatMillisecond","formatSecond","formatMinute","formatHour","formatDay","formatMonth","formatYear","prefixSIFormat","format","exponentFormat","roundFormat","getDefaultFormat","type","date","ax","timeSecond","timeMinute","timeHour","timeDay","timeMonth","timeYear","v","computeSize","element","width","height","padding","rWidth","rHeight","w","h","style","getComputedStyle","util","isNumber","clientWidth","parseInt","paddingLeft","paddingRight","clientHeight","paddingTop","paddingBottom","top","right","bottom","left","pad","Array","isArray","pad0","pad1","pad2","pad3","length","Math","max","scaleLable","labelSel","scale","domain","label","unit","min","select","selectAll","data","join","attr","_","i","text","getScaleAxis","zoomSelection$","datum","xTransform","yTransform","scaleAxis","forEach","key","rescale$","axis","updateScale","axisScale$","dataDomains$","minDomain","maxDomain","range","width$","height$","nice","niceDomain","createScale","axisScale","ticks","tickSize","axisTop","axisLeft","axisRight","axisBottom","defaultFormat","tickFormat","val","call","transform","as","recale","rescaleX","rescaleY","updateZoom","viewExtent","scaleExtent","translateExtent","zoom","xzoom","x","yzoom","y","map","xdomain","ydomain","xMinDomain","xMaxDomain","yMinDomain","yMaxDomain","xDomainEx","yDomainEx","translate","Infinity","xMinTranslate","xMaxTranslate","yMinTranslate","yMaxTranslate","precision","xMinPrecision","xMaxPrecision","yMinPrecision","yMaxPrecision","xRate","yRate","zoomer$","extent","zoomExtent$","createZoom","transform$","tf","t","p","l","tk","k","tx","ty","constrain","zoomIdentity","updateElement","size","rootSelection$","node","zw","zh","group","baselineDelt","fontSize","showRange","x2","y2","svgDiv","offset","actions","a","createElement","container","svgXmlns","rootSelection","document","append","svgSelection","pathClipId","guid","groupSelection","divSelection","zoomSelection","push","action","index","src","menus","actionSelection","menusSelection","maxWidth","menu","j","measureSvgText","tooltip","cross","split","resize","debounce","e","destroyed","rendered","resize$","sourceEvent","target","zoomTransform","leading","trailing","window","addEventListener","unBindResize$","removeEventListener","bindEvents","point","transform0","longPress","showTooltip","compute","crossX","indexOf","crossY","x0","y0","x00","y00","result","display","noop","selection","hideTooltip","zNode","parentNode","on","restEvent","touches","changedTouches","xCanZoom$","yCanZoom$","len","touch","item","pointer","invert","identifier","setTimeout","zoomstart$","newXTransform","newYTransform","eventTransform","lx","ly","np","np1","pt","p1","lx1","ly1","changed","wheel","xtf","ytf","zoomX","zoomY","Object","keys","clearTimeout","zooming$","zoomend$","click$","dblclick$","contextmenu$","preventDefault","navigator","maxTouchPoints","relatedTarget","doubleZoom","setCanZoom","canZoom$","reset$","downloadImage","am","at","stopPropagation","currentTarget","BaseChart","ext","args","ta","render","transition","duration","ease","easeLinear","canZoom","xCanZoom","yCanZoom","handler","oldHandler","computeDomain","needCompute","filter","isScale","isZoom","remove","createEvent","event","initEvent","dispatchEvent","createEventObject","fireEvent","name","content","svgSel","tempCanvas","tempCxt","getContext","clearRect","drawImage","image","tempImage","Image","btoa","unescape","encodeURIComponent","XMLSerializer","serializeToString","onload","href","toDataURL","click"],"mappings":"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","sourcesContent":["// @ts-nocheck\n/*\n * @Author: Huangjs\n * @Date: 2021-03-17 16:23:00\n * @LastEditors: Huangjs\n * @LastEditTime: 2023-03-28 15:13:28\n * @Description: 基础图表构造器\n */\n\nimport * as d3 from 'd3';\nimport * as util from '../util';\n\nconst iconSize = 18;\nconst downloadPath =\n  'M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z';\nconst resetPath =\n  'M483.031 380.989v-61.004l-162.969 92.891 162.969 99.24v-64.04c128.025 0.122 157.093 64.052 157.093 94.107 0 33.863-29.068 97.771-157.093 97.771l-98.957 0.011v63.919l98.957-0.011c157.093 0.011 221.105-63.907 221.105-159.017 0.001-96.647-64.012-163.856-221.105-163.867 M511.372 64.548c-247.628 0-448.369 200.319-448.369 447.426S263.744 959.4 511.372 959.4s448.369-200.32 448.369-447.426S758.999 64.548 511.372 64.548z m-0.203 823.564c-207.318 0-375.382-167.71-375.382-374.592s168.064-374.592 375.382-374.592 375.382 167.71 375.382 374.592-168.064 374.592-375.382 374.592z';\nconst lockPath =\n  'M650 432.6v-99.4c0-76.3-61.8-138.1-138.1-138.1S373.8 258 373.8 334.3v99.4H650z m-382.9 1.1l-0.1-3.1V322.5c0-59.9 23.8-117.4 66.2-159.8C375.6 120.3 433 96.5 493 96.5h37.9c124.8 0 225.9 101.2 225.9 225.9v111.3c58.2 8.1 101.5 57.9 101.5 116.7v258.3c0 65.1-52.7 117.8-117.8 117.8H283.3c-65.1 0-117.8-52.7-117.8-117.8V550.5c0-58.8 43.3-108.6 101.6-116.8z m217.6 266v77c0 15 12.2 27.2 27.2 27.2s27.2-12.2 27.2-27.2v-77c33.5-13.1 53-48.2 46.3-83.5-6.7-35.4-37.5-61-73.5-61s-66.9 25.6-73.5 61c-6.7 35.3 12.8 70.4 46.3 83.5z';\nconst unlockPath =\n  'M650 432.6v-99.4c0-76.3-61.8-138.1-138.1-138.1S373.8 258 373.8 334.3v99.4H650z m-382.9 1.1l-0.1-3.1V322.5c0-59.9 23.8-117.4 66.2-159.8C375.6 120.3 433 96.5 493 96.5h37.9c124.8 0 225.9 101.2 225.9 225.9v111.3c58.2 8.1 101.5 57.9 101.5 116.7v258.3c0 65.1-52.7 117.8-117.8 117.8H283.3c-65.1 0-117.8-52.7-117.8-117.8V550.5c0-58.8 43.3-108.6 101.6-116.8z m217.6 266v77c0 15 12.2 27.2 27.2 27.2s27.2-12.2 27.2-27.2v-77c33.5-13.1 53-48.2 46.3-83.5-6.7-35.4-37.5-61-73.5-61s-66.9 25.6-73.5 61c-6.7 35.3 12.8 70.4 46.3 83.5zm272 -369h-106.5v103h106.5z';\nconst actionButtons = {\n  download: {\n    title: '下载视图',\n    path: downloadPath,\n    className: 'download',\n  },\n  reset: {\n    title: '重置视图',\n    path: resetPath,\n    className: 'reset',\n  },\n  xlock: {\n    title: 'X轴缩放开关',\n    path: unlockPath,\n    className: 'xlock',\n  },\n  ylock: {\n    title: 'Y轴缩放开关',\n    path: unlockPath,\n    className: 'ylock',\n  },\n};\nconst axisType = ['x', 'x2', 'y', 'y2'];\nconst scaleType = {\n  cat: () => d3.scaleBand(),\n  timeCat: () => d3.scaleBand(),\n  time: () => d3.scaleTime(),\n  linear: () => d3.scaleLinear(),\n  log: () => d3.scaleLog(),\n  sqrt: () => d3.scaleSqrt(),\n  pow: () => d3.scalePow(),\n  // sequential: () => d3.scaleSequential(),\n  quantize: () => d3.scaleQuantize(),\n  quantile: () => d3.scaleQuantile(),\n  identity: () => d3.scaleIdentity(),\n};\nconst timeFormat = d3.timeFormat('%Y-%m-%d %H:%M:%S');\nconst formatMillisecond = d3.timeFormat('.%L');\nconst formatSecond = d3.timeFormat(':%S');\nconst formatMinute = d3.timeFormat('%H:%M');\nconst formatHour = d3.timeFormat('%H:00');\nconst formatDay = d3.timeFormat('%m-%d');\nconst formatMonth = d3.timeFormat('%m月');\nconst formatYear = d3.timeFormat('%Y年');\nconst prefixSIFormat = d3.format('.4~s');\nconst exponentFormat = d3.format('.4~g');\nconst roundFormat = d3.format('.4~r');\nconst getDefaultFormat = (type) => {\n  if (type === 'time') {\n    return (date, ax) => {\n      if (!ax) {\n        return timeFormat(date);\n      }\n      if (d3.timeSecond(date) < date) {\n        return formatMillisecond(date);\n      }\n      if (d3.timeMinute(date) < date) {\n        return formatSecond(date);\n      }\n      if (d3.timeHour(date) < date) {\n        return formatMinute(date);\n      }\n      if (d3.timeDay(date) < date) {\n        return formatHour(date);\n      }\n      if (d3.timeMonth(date) < date) {\n        return formatDay(date);\n      }\n      if (d3.timeYear(date) < date) {\n        return formatMonth(date);\n      }\n      return formatYear(date);\n    };\n  }\n  if (type === 'log') {\n    return exponentFormat;\n  }\n  if (type === 'sqrt') {\n    return roundFormat;\n  }\n  if (type === 'linear' || type === 'pow') {\n    return prefixSIFormat;\n  }\n  return (v) => v;\n};\nconst computeSize = (element, { width, height, padding, rWidth, rHeight }) => {\n  let w = width;\n  let h = height;\n  const style = getComputedStyle(element);\n  if (!(util.isNumber(width) && width > 1)) {\n    w =\n      (element.clientWidth || parseInt(style.width, 10)) -\n      parseInt(style.paddingLeft, 10) -\n      parseInt(style.paddingRight, 10);\n  }\n  if (!(util.isNumber(height) && height > 1)) {\n    h =\n      (element.clientHeight || parseInt(style.height, 10)) -\n      parseInt(style.paddingTop, 10) -\n      parseInt(style.paddingBottom, 10);\n  }\n  let [top, right, bottom, left] = [];\n  const pad = Array.isArray(padding) ? padding : [];\n  let [pad0, pad1, pad2, pad3] = pad;\n  pad0 = !util.isNumber(pad0) || pad0 < 0 ? 0 : pad0;\n  pad1 = !util.isNumber(pad1) || pad1 < 0 ? 0 : pad1;\n  pad2 = !util.isNumber(pad2) || pad2 < 0 ? 0 : pad2;\n  pad3 = !util.isNumber(pad3) || pad3 < 0 ? 0 : pad3;\n  if (!pad.length) {\n    top = 0;\n    right = top;\n    bottom = top;\n    left = top;\n  } else if (pad.length === 1) {\n    top = pad0;\n    right = top;\n    bottom = top;\n    left = top;\n  } else if (pad.length === 2) {\n    top = pad0;\n    right = pad1;\n    bottom = top;\n    left = right;\n  } else if (pad.length === 3) {\n    top = pad0;\n    right = pad1;\n    bottom = pad2;\n    left = right;\n  } else {\n    top = pad0;\n    right = pad1;\n    bottom = pad2;\n    left = pad3;\n  }\n  return {\n    width: Math.max(util.isNumber(w) ? w : 1, 1),\n    height: Math.max(util.isNumber(h) ? h : 1, 1),\n    padding: [top, right, bottom, left],\n    rWidth: util.isNumber(rWidth) ? rWidth : 0,\n    rHeight: util.isNumber(rHeight) ? rHeight : 0,\n  };\n};\nconst scaleLable = (labelSel, [scale, domain]) => {\n  let { type, format, label, unit } = scale;\n  type = type || 'linear';\n  label = label || '';\n  unit = !label || !unit ? '' : ` ( ${unit} )`;\n  format = format || getDefaultFormat(type);\n  let [min, max] = domain;\n  min = min || 0;\n  max = max || 0;\n  labelSel\n    .select('text')\n    .selectAll('tspan')\n    .data([0, 1])\n    .join('tspan')\n    .attr('dx', (_, i) => {\n      if (!label) return 0;\n      return i === 0 ? -12 : 12;\n    })\n    .text((_, i) => (i === 0 ? `${label}${unit}` : `${format(min)} - ${format(max)}`));\n};\nfunction getScaleAxis() {\n  const [xTransform, yTransform] = this.zoomSelection$.datum();\n  const scaleAxis = {};\n  axisType.forEach((key) => {\n    if (this.scale[key]) {\n      const { scale, axis } = this.rescale$(key === 'x' || key === 'x2' ? xTransform : yTransform, key);\n      scaleAxis[key] = {\n        axis,\n        scale,\n      };\n    }\n  });\n  return scaleAxis;\n}\nfunction updateScale() {\n  axisType.forEach((key) => {\n    if (this.axisScale$[key]) {\n      const [minDomain, maxDomain] = this.scale[key].domain || this.dataDomains$[key] || [0, 1];\n      this.axisScale$[key].scale\n        .range(key === 'x' || key === 'x2' ? [0, this.width$] : [this.height$, 0])\n        .domain([minDomain || 0, maxDomain || 1]);\n      if (this.scale[key].nice) {\n        this.axisScale$[key].scale.nice();\n        const niceDomain = this.axisScale$[key].scale.domain();\n        if (this.scale[key].domain) {\n          this.scale[key].domain = niceDomain;\n        }\n        if (this.dataDomains$[key]) {\n          this.dataDomains$[key] = niceDomain;\n        }\n      }\n    }\n  });\n}\nfunction createScale() {\n  const axisScale = {};\n  axisType.forEach((key) => {\n    if (this.scale[key]) {\n      const { type = 'linear', ticks = 5, tickSize, format } = this.scale[key];\n      const scale = scaleType[type]();\n      let axis = null;\n      if (key === 'x2') {\n        axis = d3.axisTop(scale);\n      } else if (key === 'y') {\n        axis = d3.axisLeft(scale);\n      } else if (key === 'y2') {\n        axis = d3.axisRight(scale);\n      } else {\n        axis = d3.axisBottom(scale);\n      }\n      if (ticks) {\n        axis = axis.ticks(ticks);\n      }\n      if (tickSize) {\n        axis = axis.tickSize(tickSize);\n      }\n      const defaultFormat = getDefaultFormat(type);\n      if (!format) {\n        this.scale[key].format = defaultFormat;\n      }\n      axis = axis.tickFormat(format || ((val) => defaultFormat(val, true)));\n      axisScale[key] = { scale, axis };\n    }\n  });\n  this.axisScale$ = axisScale;\n  updateScale.call(this);\n  this.rescale$ = (transform, key) => {\n    const as = this.axisScale$[key];\n    if (as) {\n      const { scale, axis } = as;\n      const recale = key === 'x' || key === 'x2' ? transform.rescaleX(scale) : transform.rescaleY(scale);\n      return {\n        scale: recale,\n        axis: axis.scale(recale),\n      };\n    }\n    return as;\n  };\n}\nfunction updateZoom() {\n  const viewExtent = [\n    [0, 0],\n    [this.width$, this.height$],\n  ];\n  let scaleExtent = [\n    [1, 1],\n    [1, 1],\n  ];\n  let translateExtent = [\n    [0, 0],\n    [0, 0],\n  ];\n  const { x: xzoom, y: yzoom } = this.zoom;\n  if (xzoom || yzoom) {\n    const [xdomain, ydomain] = [xzoom, yzoom].map((zoom, i) => {\n      const key = zoom.domain || (i === 0 ? 'x' : 'y');\n      let domain = [0, 1];\n      if (this.scale[key]) {\n        domain = this.scale[key].domain || this.dataDomains$[key] || [0, 1];\n      }\n      return domain;\n    });\n    const [xMinDomain, xMaxDomain] = xdomain;\n    const [yMinDomain, yMaxDomain] = ydomain;\n    const xDomainEx = (xMaxDomain || 1) - (xMinDomain || 0);\n    const yDomainEx = (yMaxDomain || 1) - (yMinDomain || 0);\n    const [xMinTranslate = 0, xMaxTranslate = 0] = xzoom.translate || [-Infinity, Infinity];\n    const [yMinTranslate = 0, yMaxTranslate = 0] = yzoom.translate || [-Infinity, Infinity];\n    const [xMinPrecision = xDomainEx / 10, xMaxPrecision = xDomainEx * 10] = xzoom.precision || [\n      xDomainEx / 10,\n      xDomainEx * 10,\n    ];\n    const [yMinPrecision = yDomainEx / 10, yMaxPrecision = yDomainEx * 10] = yzoom.precision || [\n      yDomainEx / 10,\n      yDomainEx * 10,\n    ];\n    const xRate = this.width$ / xDomainEx;\n    const yRate = this.height$ / yDomainEx;\n    scaleExtent = [\n      [xDomainEx / xMaxPrecision || 1, yDomainEx / yMaxPrecision || 1],\n      [xDomainEx / xMinPrecision || 1, yDomainEx / yMinPrecision || 1],\n    ];\n    translateExtent = [\n      [\n        (xMinTranslate - (xMinDomain || 0)) * xRate || xMinDomain || 0,\n        ((yMaxDomain || 1) - yMaxTranslate) * yRate || yMinDomain || 0,\n      ],\n      [\n        (xMaxTranslate - (xMinDomain || 0)) * xRate || xMaxDomain || 1,\n        ((yMaxDomain || 1) - yMinTranslate) * yRate || yMaxDomain || 1,\n      ],\n    ];\n  }\n  this.zoomer$\n    .extent(viewExtent)\n    .scaleExtent([(scaleExtent[0][0] * scaleExtent[0][1]) ** 2, (scaleExtent[1][0] * scaleExtent[1][1]) ** 2])\n    .translateExtent(translateExtent);\n  this.zoomExtent$ = { viewExtent, scaleExtent, translateExtent };\n}\nfunction createZoom() {\n  this.zoomExtent$ = null;\n  updateZoom.call(this);\n  this.transform$ = (axis, tf, t, p, l) => {\n    let transform = tf;\n    if (this.zoomExtent$) {\n      const { viewExtent, translateExtent, scaleExtent } = this.zoomExtent$;\n      const tk = Math.max(\n        axis === 'x' ? scaleExtent[0][0] : scaleExtent[0][1],\n        Math.min(axis === 'x' ? scaleExtent[1][0] : scaleExtent[1][1], transform.k * t)\n      );\n      const tx = p[0] - tk * l[0];\n      const ty = p[1] - tk * l[1];\n      if (tk !== transform.k || tx !== transform.x || ty !== transform.y) {\n        transform = this.zoomer$.constrain()(d3.zoomIdentity.translate(tx, ty).scale(tk), viewExtent, translateExtent);\n      }\n    }\n    return transform;\n  };\n}\nfunction updateElement(size) {\n  const { width, height, padding, rWidth, rHeight } = computeSize(this.rootSelection$.node(), size);\n  let zw = width - rWidth - padding[3] - padding[1];\n  let zh = height - rHeight - padding[0] - padding[2];\n  if (zw < 1) zw = 1;\n  if (zh < 1) zh = 1;\n  const group = this.rootSelection$\n    .select('svg')\n    .attr('width', width)\n    .attr('height', height)\n    .select('g.group')\n    .attr('transform', `translate(${padding[3]},${padding[0]})`);\n  this.rootSelection$.select('clipPath').select('rect').attr('width', zw).attr('height', zh);\n  const baselineDelt = this.fontSize + 2;\n  if (this.scale.x) {\n    group.select('.xAxis').attr('transform', `translate(0,${zh})`);\n    if (this.scale.x.showRange || typeof this.scale.x.showRange === 'undefined') {\n      group\n        .select('.xLabel')\n        .attr('transform', `translate(${zw / 2} ${zh + padding[2] - iconSize + baselineDelt}) rotate(0)`);\n    }\n  }\n  if (this.scale.x2 && (this.scale.x2.showRange || typeof this.scale.x2.showRange === 'undefined')) {\n    group.select('.x2Label').attr('transform', `translate(${zw / 2} ${baselineDelt - padding[0]}) rotate(0)`);\n  }\n  if (this.scale.y && (this.scale.y.showRange || typeof this.scale.y.showRange === 'undefined')) {\n    group.select('.yLabel').attr('transform', `translate(${baselineDelt - padding[3]} ${zh / 2}) rotate(-90)`);\n  }\n  if (this.scale.y2) {\n    group.select('.y2Axis').attr('transform', `translate(${zw},0)`);\n    if (this.scale.y2.showRange || typeof this.scale.y2.showRange === 'undefined') {\n      group\n        .select('.y2Label')\n        .attr('transform', `translate(${zw + padding[1] - iconSize + baselineDelt} ${zh / 2}) rotate(-90)`);\n    }\n  }\n  const svgDiv = this.rootSelection$\n    .select('div.actions')\n    .style('width', `${zw}px`)\n    .style('height', `${zh}px`)\n    .style('top', `${padding[0]}px`)\n    .style('left', `${padding[3]}px`);\n  if (this.zoom.x) {\n    svgDiv\n      .select('.xlock')\n      .style('top', `${this.scale.x ? zh + padding[2] - iconSize : -padding[0]}px`)\n      .style('left', `${this.scale.y ? zw - iconSize / 2 : -iconSize / 2}px`);\n  }\n  if (this.zoom.y) {\n    svgDiv\n      .select('.ylock')\n      .style('top', `${this.scale.x ? -iconSize / 2 : zh - iconSize / 2}px`)\n      .style('left', `${this.scale.y ? -padding[3] : zw + padding[1] - iconSize}px`);\n  }\n  let offset = 5;\n  if (this.zoom.x || this.zoom.y) {\n    svgDiv\n      .select('.reset')\n      .style('top', `${this.scale.x ? -padding[0] : zh + padding[2] - iconSize}px`)\n      .style('left', `${this.scale.y ? zw - offset - iconSize : offset}px`);\n    offset += 23;\n  }\n  if (this.download) {\n    svgDiv\n      .select('.download')\n      .style('top', `${this.scale.x ? -padding[0] : zh + padding[2] - iconSize}px`)\n      .style('left', `${this.scale.y ? zw - offset - iconSize : offset}px`);\n    offset += 23;\n  }\n  this.actions.forEach((a, i) => {\n    if (!a) return;\n    svgDiv\n      .select(`.action-${i}`)\n      .style('top', `${this.scale.x ? -padding[0] : zh + padding[2] - iconSize}px`)\n      .style('left', `${this.scale.y ? zw - offset - iconSize : offset}px`);\n    offset += 23;\n  });\n  group\n    .select('.zLabel')\n    .attr(\n      'transform',\n      `translate(${this.scale.y ? zw - offset : offset} ${\n        (this.scale.x ? -padding[0] : zh + padding[2] - iconSize) + baselineDelt\n      })`\n    );\n\n  this.width = width;\n  this.height = height;\n  this.padding = padding;\n  this.width$ = zw;\n  this.height$ = zh;\n}\nfunction createElement(container, size) {\n  const svgXmlns = 'http://www.w3.org/2000/svg';\n  const rootSelection = d3\n    .select(container || document.createElement('div'))\n    .append('div')\n    .attr('class', 'd3chart')\n    .style('position', 'relative')\n    // .style('overflow', 'hidden')\n    .style('width', '100%')\n    .style('height', '100%');\n  const svgSelection = rootSelection\n    .append('svg')\n    .attr('xmlns', svgXmlns)\n    .attr('width', 1) // 清除默认宽高\n    .attr('height', 1) // 清除默认宽高\n    .attr('fill', 'none')\n    .attr('text-anchor', 'middle')\n    .attr('font-size', this.fontSize)\n    .attr('stroke', 'none')\n    .attr('stroke-width', 1)\n    .attr('stroke-linejoin', 'round')\n    .attr('stroke-linecap', 'round')\n    .style('position', 'absolute');\n  const pathClipId = util.guid('clip');\n  svgSelection.append('defs').append('svg:clipPath').attr('id', pathClipId).append('rect');\n  const groupSelection = svgSelection.append('g').attr('class', 'group');\n  axisType.forEach((key) => {\n    if (this.scale[key]) {\n      groupSelection.append('g').attr('class', `${key}Axis`);\n      if (this.scale[key].showRange || typeof this.scale[key].showRange === 'undefined') {\n        groupSelection.append('g').attr('class', `${key}Label`).attr('fill', 'currentColor').append('text');\n      }\n    }\n  });\n  groupSelection.append('g').attr('class', 'zAxis').attr('clip-path', `url(#${pathClipId})`);\n  groupSelection.append('g').attr('class', 'zLabel').attr('fill', 'currentColor');\n  const divSelection = rootSelection\n    .append('div')\n    .attr('class', 'actions')\n    .style('position', 'absolute')\n    .style('top', 0)\n    .style('left', 0);\n  const zoomSelection = divSelection\n    .append('div')\n    .attr('class', 'xyzoom')\n    .style('position', 'absolute')\n    // .style('overflow', 'hidden')\n    .style('background', 'rgba(0,0,0,0)') // IE9,10的层级（z-index）不起作用，需要加个背景使鼠标事件生效\n    .style('width', '100%')\n    .style('height', '100%')\n    .style('top', 0)\n    .style('left', 0);\n  const actions = [];\n  if (this.zoom) {\n    if (this.zoom.x) {\n      actions.push(actionButtons.xlock);\n    }\n    if (this.zoom.y) {\n      actions.push(actionButtons.ylock);\n    }\n    if (this.zoom.x || this.zoom.y) {\n      actions.push(actionButtons.reset);\n    }\n  }\n  if (this.download) {\n    actions.push(actionButtons.download);\n  }\n  [...actions, ...this.actions].forEach((action, i) => {\n    const index = i - actions.length;\n    if (!action) return;\n    const { className, title, path, text, src, menus } = action;\n    const actionSelection = divSelection\n      .append('div')\n      .attr('class', index < 0 ? className : `action-${index}`)\n      .style('position', 'absolute')\n      .attr('title', title || '')\n      .style('display', 'inline-flex')\n      .style('font-size', `${path ? iconSize : 12}px`);\n    if (path) {\n      actionSelection\n        .append('svg')\n        .attr('xmlns', svgXmlns)\n        .attr('fill', 'currentColor')\n        .attr('viewBox', '0 0 1024 1024')\n        .attr('width', '1em')\n        .attr('height', '1em')\n        .append('path')\n        .attr('d', path);\n    } else if (text) {\n      actionSelection.append('span').text(text);\n    } else if (src) {\n      actionSelection.append('img').attr('src', src).attr('width', iconSize).attr('height', iconSize);\n    }\n    if (Array.isArray(menus)) {\n      const menusSelection = actionSelection\n        .append('div')\n        .attr('class', `action-menu action-${index}-menu`)\n        .style('position', 'absolute')\n        .style('top', '24px')\n        .style('font-size', '12px')\n        .style('padding', '6px 0px');\n      let maxWidth = 0;\n      menus.forEach((menu, j) => {\n        if (!menu) return;\n        const { text } = menu;\n        maxWidth = Math.max(maxWidth, util.measureSvgText(text, 12));\n        menusSelection.append('div').attr('class', `action-${index}-menu-${j}`).style('padding', '6px 12px').text(text);\n      });\n      menusSelection\n        .style('width', `${maxWidth + 24}px`)\n        .style('left', `${-(maxWidth + 24) / 2}px`)\n        .style('display', 'none');\n    }\n  });\n  if (this.tooltip) {\n    const { cross } = this.tooltip;\n    zoomSelection\n      .append('div')\n      .attr('class', 'tooltip')\n      .style('display', 'none')\n      .style('z-index', '999')\n      .style('border-radius', '8px')\n      .style('transition', 'none')\n      .style('padding', '10px 14px')\n      .style('font-size', `${this.fontSize}px`)\n      .style('line-height', '22px')\n      .style('position', 'absolute')\n      .style('top', 0)\n      .style('left', 0);\n    cross.split('').forEach((key) => {\n      if (key) {\n        zoomSelection\n          .append('div')\n          .attr('class', `${key}-cross`)\n          .style('display', 'none')\n          .style('position', 'absolute')\n          .style('transition', 'none')\n          .style('width', key === 'x' ? '1px' : '100%')\n          .style('height', key === 'x' ? '100%' : '1px')\n          .style('top', 0)\n          .style('left', 0);\n      }\n    });\n  }\n  this.rootSelection$ = rootSelection;\n  this.zoomSelection$ = zoomSelection;\n  updateElement.call(this, size);\n  if (!(util.isNumber(size.width) && size.width > 1 && util.isNumber(size.height) && size.height > 1)) {\n    const resize = util.debounce(\n      (e) => {\n        if (this.destroyed) return;\n        updateElement.call(this, size);\n        updateScale.call(this);\n        updateZoom.call(this);\n        if (this.rendered) {\n          this.reset();\n        }\n        this.resize$.call(\n          null,\n          {\n            sourceEvent: e || null,\n            target: this.rootSelection$,\n            transform: [d3.zoomTransform(this.zoomSelection$.node()), ...this.zoomSelection$.datum()],\n            scaleAxis: getScaleAxis.call(this),\n            type: 'resize',\n          },\n          {\n            width: this.width$,\n            height: this.height$,\n            padding: this.padding,\n          }\n        );\n      },\n      250,\n      { leading: false, trailing: true }\n    );\n    window.addEventListener('resize', resize);\n    this.unBindResize$ = () => {\n      window.removeEventListener('resize', resize);\n    };\n  }\n}\nfunction bindEvents() {\n  let point = null;\n  let transform0 = null;\n  let longPress = 0;\n  const showTooltip = (point) => {\n    if (this.tooltip) {\n      const { cross, compute } = this.tooltip;\n      const crossX = cross.indexOf('x') !== -1;\n      const crossY = cross.indexOf('y') !== -1;\n      if (crossX || crossY) {\n        const [x0, y0] = point;\n        let { x0: x00, y0: y00, result } = compute([x0, y0], getScaleAxis.call(this));\n        x00 = x00 || x00 === 0 ? x00 : x0;\n        y00 = y00 || y00 === 0 ? y00 : y0;\n        let display = 'none';\n        if (typeof result !== 'function') {\n          result = util.noop;\n        } else {\n          display = 'block';\n        }\n        if (crossX) {\n          selection.select('.x-cross').style('left', `${x00}px`).style('display', display);\n        }\n        if (crossY) {\n          selection.select('.y-cross').style('top', `${y00}px`).style('display', display);\n        }\n        const tooltip = selection.select('.tooltip');\n        tooltip.style('display', display).call(result);\n        if (display !== 'none') {\n          const width = tooltip.node().clientWidth;\n          const height = tooltip.node().clientHeight;\n          let left = x0 + 10;\n          let top = y0 - height - 10;\n          if (this.width$ - left < width) {\n            left = x0 - 10 - width;\n          }\n          left = left <= -60 ? -60 : left;\n          top = top <= -20 ? -20 : top;\n          tooltip.style('left', `${left}px`).style('top', `${top}px`);\n        }\n      }\n    }\n  };\n  const hideTooltip = (target) => {\n    if (this.tooltip) {\n      const { cross } = this.tooltip;\n      const zNode = element;\n      if (!target || (target !== zNode && target.parentNode !== zNode)) {\n        if (cross.indexOf('x') !== -1) {\n          selection.select('.x-cross').style('display', 'none');\n        }\n        if (cross.indexOf('y') !== -1) {\n          selection.select('.y-cross').style('display', 'none');\n        }\n        selection.select('.tooltip').style('display', 'none');\n      }\n    }\n  };\n  const selection = this.zoomSelection$;\n  const element = selection\n    .call(\n      this.zoomer$\n        .on('start', ({ transform, sourceEvent, ...restEvent }, [xTransform, yTransform]) => {\n          if (this.destroyed || !this.rendered) return;\n          const { type } = sourceEvent;\n          // 移动端双击放大的时候，因为是模拟的双击，所以event实际传过来的是touchend的事件对象\n          const touches = type === 'touchend' ? sourceEvent.changedTouches : sourceEvent.touches;\n          if (type !== 'call' && (this.xCanZoom$ || this.yCanZoom$)) {\n            let p = null;\n            if (touches) {\n              // 表示移动端触摸事件\n              point = [];\n              for (let i = 0, len = touches.length; i < len; i += 1) {\n                const touch = touches.item(i);\n                p = d3.pointer(touch, element);\n                p = [p, [xTransform.invert(p), yTransform.invert(p)], touch.identifier];\n                if (!point[0]) point[0] = p;\n                else if (!point[1] && point[0][2] !== p[2]) point[1] = p;\n              }\n            } else {\n              p = d3.pointer(sourceEvent, element);\n              p = [p, [xTransform.invert(p), yTransform.invert(p)]];\n              point = p;\n            }\n            transform0 = transform;\n          }\n          if (touches) {\n            longPress = setTimeout(() => {\n              showTooltip(d3.pointer(touches.item(0), element));\n              longPress = 0;\n            }, 500);\n          }\n          this.zoomstart$.call(null, {\n            ...restEvent,\n            sourceEvent,\n            scaleAxis: getScaleAxis.call(this),\n            transform: [transform, xTransform, yTransform],\n          });\n        })\n        .on('zoom', ({ transform, sourceEvent, ...restEvent }, [xTransform, yTransform]) => {\n          if (this.destroyed || !this.rendered) return;\n          let [newXTransform, newYTransform] = [xTransform, yTransform];\n          const { type, changedTouches: touches, transform: eventTransform } = sourceEvent;\n          // 表示事用户主动触发，如滚轮和移动，触摸缩放\n          if (type !== 'call') {\n            if (this.xCanZoom$ || this.yCanZoom$) {\n              const t = transform.k / transform0.k;\n              let p = null;\n              let lx = null;\n              let ly = null;\n              if (touches) {\n                // 表示移动端触摸事件\n                let np = null;\n                let np1 = null;\n                for (let i = 0, len = touches.length; i < len; i += 1) {\n                  const touch = touches.item(i);\n                  const pt = d3.pointer(touch, element);\n                  if (point[0] && point[0][2] === touch.identifier) np = pt;\n                  else if (point[1] && point[1][2] === touch.identifier) np1 = pt;\n                }\n                if (point[0]) {\n                  p = np || point[0][0];\n                  lx = this.xCanZoom$ && point[0][1][0];\n                  ly = this.yCanZoom$ && point[0][1][1];\n                  if (point[1]) {\n                    const p1 = np1 || point[1][0];\n                    const [lx1, ly1] = point[1][1];\n                    p = [(p[0] + p1[0]) / 2, (p[1] + p1[1]) / 2];\n                    lx = this.xCanZoom$ && [(lx[0] + lx1[0]) / 2, (lx[1] + lx1[1]) / 2];\n                    ly = this.yCanZoom$ && [(ly[0] + ly1[0]) / 2, (ly[1] + ly1[1]) / 2];\n                  }\n                }\n              } else {\n                p = d3.pointer(sourceEvent, element);\n                const changed = p[0] !== point[0][0] || p[1] !== point[0][1]; // zoom的时候点（鼠标）是否移动过\n                const wheel = type === 'wheel'; // 是否是滚轮\n                if (wheel && !changed) p = point[0];\n                lx = this.xCanZoom$ && (wheel && changed ? xTransform.invert(p) : point[1][0]);\n                ly = this.yCanZoom$ && (wheel && changed ? yTransform.invert(p) : point[1][1]);\n              }\n              if (p) {\n                if (lx) {\n                  newXTransform = this.transform$('x', xTransform, t, p, lx);\n                }\n                if (ly) {\n                  newYTransform = this.transform$('y', yTransform, t, p, ly);\n                }\n              }\n              transform0 = transform;\n            }\n          } else if (eventTransform) {\n            // 如果存在xy缩放，则会有补间调用，万一补间一半，触发了滚轮或移动，则补间会停止，造成无法到达指定缩放位置，所以xy锁定的时候应该忽略补间\n            // transform和eventTransform原本是一样的，但是动画补间的每一次调用时transform会变化，直到最后一次才会和eventTransform一样\n            // eventTransform是不变的，是最终的指定的变换结果\n            let xtf = transform;\n            let ytf = transform;\n            if (Array.isArray(eventTransform)) {\n              xtf = eventTransform[1];\n              ytf = eventTransform[2];\n            } else {\n              if (!this.xCanZoom$) xtf = eventTransform;\n              if (!this.yCanZoom$) ytf = eventTransform;\n            }\n            if (sourceEvent.zoomX) {\n              newXTransform = xtf;\n            }\n            if (sourceEvent.zoomY) {\n              newYTransform = ytf;\n            }\n          }\n          selection.datum([newXTransform, newYTransform]);\n          const scaleAxis = getScaleAxis.call(this);\n          Object.keys(scaleAxis).forEach((key) => {\n            const { axis, scale } = scaleAxis[key];\n            this.rootSelection$.select(`.${key}Axis`).call(axis);\n            this.rootSelection$.select(`.${key}Label`).call(scaleLable, [this.scale[key], scale.domain()]);\n          });\n          if (touches) {\n            if (longPress != 0) {\n              clearTimeout(longPress);\n              longPress = 0;\n            }\n            hideTooltip();\n          }\n          this.zooming$.call(null, {\n            ...restEvent,\n            sourceEvent,\n            transform: [transform, newXTransform, newYTransform],\n            scaleAxis,\n          });\n        })\n        .on('end', ({ transform, sourceEvent, ...restEvent }, [xTransform, yTransform]) => {\n          if (this.destroyed || !this.rendered) return;\n          if (sourceEvent.type !== 'call' && (this.xCanZoom$ || this.yCanZoom$)) {\n            point = null;\n            transform0 = null;\n          }\n          if (sourceEvent.changedTouches) {\n            if (longPress != 0) {\n              clearTimeout(longPress);\n              longPress = 0;\n              hideTooltip();\n            }\n          }\n          this.zoomend$.call(null, {\n            ...restEvent,\n            sourceEvent,\n            transform: [transform, xTransform, yTransform],\n            scaleAxis: getScaleAxis.call(this),\n          });\n        })\n    )\n    .on('click', (e) => {\n      if (this.destroyed) return;\n      this.click$.call(null, {\n        sourceEvent: e,\n        target: selection,\n        transform: [d3.zoomTransform(element), ...selection.datum()],\n        scaleAxis: getScaleAxis.call(this),\n        type: 'click',\n      });\n    })\n    .on('dblclick', (e) => {\n      if (this.destroyed) return;\n      this.dblclick$.call(null, {\n        sourceEvent: e,\n        target: selection,\n        transform: [d3.zoomTransform(element), ...selection.datum()],\n        scaleAxis: getScaleAxis.call(this),\n        type: 'dblclick',\n      });\n    })\n    .on('contextmenu', (e) => {\n      if (this.destroyed) return;\n      this.contextmenu$.call(null, {\n        sourceEvent: e,\n        target: selection,\n        transform: [d3.zoomTransform(element), ...selection.datum()],\n        scaleAxis: getScaleAxis.call(this),\n        type: 'contextmenu',\n      });\n      e.preventDefault();\n    })\n    .datum([d3.zoomIdentity, d3.zoomIdentity])\n    .node();\n  if (!(window.navigator.maxTouchPoints || 'ontouchstart' in window)) {\n    selection\n      .on('mouseout', (e) => {\n        if (this.destroyed || !this.rendered) return;\n        hideTooltip(e.relatedTarget);\n      })\n      .on('mousemove', (e) => {\n        if (this.destroyed || !this.rendered) return;\n        showTooltip(d3.pointer(e));\n      });\n  }\n  if (!this.zoom.doubleZoom) {\n    // 取消双击放大\n    selection.on('dblclick.zoom', null);\n  }\n  if (this.zoom.x) {\n    const xlock = this.rootSelection$.select('.xlock');\n    xlock.on('click', () => {\n      if (this.destroyed) return;\n      this.setCanZoom('x', !this.xCanZoom$);\n      this.canZoom$('x', this.xCanZoom$);\n    });\n  }\n  if (this.zoom.y) {\n    const ylock = this.rootSelection$.select('.ylock');\n    ylock.on('click', () => {\n      if (this.destroyed) return;\n      this.setCanZoom('y', !this.yCanZoom$);\n      this.canZoom$('y', this.yCanZoom$);\n    });\n  }\n  if (this.zoom.x || this.zoom.y) {\n    this.rootSelection$.select('.reset').on('click', () => {\n      if (this.destroyed) return;\n      this.reset();\n      this.reset$();\n    });\n  }\n  if (this.download) {\n    this.rootSelection$.select('.download').on('click', () => {\n      if (this.destroyed) return;\n      if (this.download.action) {\n        this.download.action(() => {\n          this.downloadImage();\n        }, this.rootSelection$);\n      } else {\n        this.downloadImage();\n      }\n    });\n  }\n  this.actions.forEach((a, i) => {\n    if (!a) return;\n    const { action, menus } = a;\n    const am = this.rootSelection$.select(`.action-${i}-menu`);\n    const at = this.rootSelection$.select(`.action-${i}`);\n    at.on('click', (e) => {\n      e.stopPropagation();\n      if (e.currentTarget === at.node()) {\n        if (this.destroyed) return;\n        if (action) {\n          action(this.rootSelection$, () => {});\n        }\n        const display = am.style('display');\n        am.style('display', display === 'none' ? 'block' : 'none');\n      }\n    });\n    if (Array.isArray(menus)) {\n      menus.forEach((menu, j) => {\n        if (!menu) return;\n        this.rootSelection$.select(`.action-${i}-menu-${j}`).on('click', (e) => {\n          e.stopPropagation();\n          if (this.destroyed) return;\n          if (menu.action) {\n            menu.action(this.rootSelection$, () => {});\n          }\n          am.style('display', 'none');\n        });\n      });\n    }\n  });\n  if (this.actions.length) {\n    d3.select('body').on('click', () => {\n      this.rootSelection$.selectAll('.action-menu').style('display', 'none');\n    });\n  }\n}\n\nclass BaseChart {\n  constructor(...params) {\n    const {\n      container,\n      width,\n      height,\n      padding = [0, 0, 0, 0],\n      rWidth,\n      rHeight,\n      fontSize = 12,\n      download,\n      actions,\n      tooltip,\n      zoom,\n      scale,\n      data,\n    } = params[0] || {};\n    this.destroyed = false;\n    this.rendered = false;\n    if (typeof download === 'function') {\n      this.download = { action: download };\n    } else if (typeof download === 'string') {\n      this.download = { ext: download };\n    } else {\n      this.download = download || false;\n    }\n    this.tooltip = !tooltip\n      ? false\n      : {\n          cross: '',\n          ...tooltip,\n          compute: (...args) => {\n            let result = {};\n            if (typeof tooltip.compute === 'function') {\n              result = tooltip.compute.call(this, result, ...args);\n            }\n            return result;\n          },\n        };\n    this.zoom = {\n      /* x: {\n\t\t\t\t\t// 一旦domain设置了x或x2的某一类型，则translate和precision都要按照这一类型数据设置\n\t\t\t\t\tdomain: 'x', // 坐标缩放为1，位移为0时的坐标范围（会默认取scale的x或x2的domain)\n\t\t\t\t\ttranslate: [-Infinity, Infinity], // 坐标标尺可以拖动的范围值\n\t\t\t\t\tprecision: [(1 - 0) / 10, (1 - 0) * 10], // 坐标标尺缩到最小和最大的跨度值\n\t\t\t\t}, */\n      x: null,\n      y: null,\n      doubleZoom: false,\n      ...zoom,\n    };\n    this.scale = {\n      /* x: {\n\t\t\t\t\ttype: 'linear', // 坐标类型\n\t\t\t\t\tticks: 5, // 坐标刻度数目\n\t\t\t\t\tformat: (v) => v, // 坐标值格式化函数\n\t\t\t\t\tdomain: [0, 1], // 横坐标缩放为1，位移为0时的坐标范围\n\t\t\t\t\tlabel: '', // 坐标名称\n\t\t\t\t\tunit: '', // 坐标值单位\n\t\t\t\t}, */\n      x: null,\n      x2: null,\n      y: null,\n      y2: null,\n      ...scale,\n    };\n    this.actions = Array.isArray(actions) ? actions : [];\n    this.fontSize = fontSize;\n    this.data = data || {};\n    this.dataDomains$ = {};\n    this.zoomer$ = d3.zoom();\n    this.xCanZoom$ = !!this.zoom.x;\n    this.yCanZoom$ = !!this.zoom.y;\n    createElement.call(this, container, { width, height, padding, rWidth, rHeight });\n    createScale.call(this);\n    createZoom.call(this);\n    bindEvents.call(this);\n    this.click$ = util.noop;\n    this.dblclick$ = util.noop;\n    this.contextmenu$ = util.noop;\n    this.zoomstart$ = util.noop;\n    this.zooming$ = util.noop;\n    this.zoomend$ = util.noop;\n    this.resize$ = util.noop;\n    this.reset$ = util.noop;\n    this.canZoom$ = util.noop;\n  }\n\n  reset(ta) {\n    this.render(d3.zoomIdentity, 'xy', ta);\n    return this;\n  }\n\n  render(tf, ax = 'xy', ta = true) {\n    this.rendered = true;\n    const transform = (Array.isArray(tf) ? tf[0] : tf) || d3.zoomTransform(this.zoomSelection$.node());\n    // 对this.zoomSelection$调用this.zoomer$.transform函数变换到指定的transform\n    // 变换过程中用240ms及ease函数进行transition\n    (!ta ? this.zoomSelection$ : this.zoomSelection$.transition().duration(240).ease(d3.easeLinear)).call(\n      this.zoomer$.transform,\n      transform,\n      null,\n      {\n        type: 'call',\n        transform: tf,\n        zoomX: ax.indexOf('x') !== -1,\n        zoomY: ax.indexOf('y') !== -1,\n      }\n    );\n    return this;\n  }\n\n  getCanZoom() {\n    return [this.xCanZoom$, this.yCanZoom$];\n  }\n\n  getTransform() {\n    return [d3.zoomTransform(this.zoomSelection$.node()), ...this.zoomSelection$.datum()];\n  }\n\n  setCanZoom(ax = 'xy', canZoom = true) {\n    let xCanZoom = canZoom;\n    let yCanZoom = canZoom;\n    if (Array.isArray(canZoom)) {\n      [xCanZoom = true, yCanZoom = true] = canZoom;\n    }\n    if (ax.indexOf('x') !== -1) {\n      this.xCanZoom$ = xCanZoom;\n      this.rootSelection$\n        .select('.xlock')\n        .select('path')\n        .attr('d', xCanZoom ? unlockPath : lockPath);\n    }\n    if (ax.indexOf('y') !== -1) {\n      this.yCanZoom$ = yCanZoom;\n      this.rootSelection$\n        .select('.ylock')\n        .select('path')\n        .attr('d', yCanZoom ? unlockPath : lockPath);\n    }\n    return this;\n  }\n\n  setEvent(type, handler) {\n    if (typeof handler === 'function') {\n      const oldHandler = this[`${type}$`];\n      this[`${type}$`] = (...args) => {\n        handler.call(null, ...args, oldHandler.call(null, ...args));\n      };\n    }\n  }\n\n  runEvent(type, data = {}) {\n    if (this.destroyed) return;\n    const { sourceEvent, transform, scaleAxis, target } = data;\n    this[`${type}$`].call(null, {\n      type,\n      sourceEvent: sourceEvent || null,\n      target: target || this.zoomSelection$,\n      transform: transform || [d3.zoomTransform(this.zoomSelection$.node()), ...this.zoomSelection$.datum()],\n      scaleAxis: scaleAxis || getScaleAxis.call(this),\n    });\n  }\n\n  getData() {\n    return this.data;\n  }\n\n  setData(data, render, computeDomain = util.noop) {\n    if (!data) return this;\n    this.rendered = false;\n    this.data = data;\n    // 根据data计算domain\n    const needCompute = axisType.filter((key) => this.scale[key] && !this.scale[key].domain);\n    if (needCompute.length > 0) {\n      this.dataDomains$ = computeDomain(this.data, needCompute) || {};\n      updateScale.call(this);\n      updateZoom.call(this);\n    }\n    if (render) {\n      this.render();\n    }\n    return this;\n  }\n\n  setDomain(domain, render) {\n    if (!domain) return this;\n    let isScale = false;\n    axisType.forEach((key) => {\n      if (this.scale[key] && domain[key]) {\n        this.scale[key].domain = domain[key];\n        isScale = true;\n      }\n    });\n    if (isScale) {\n      this.rendered = false;\n      updateScale.call(this);\n      let isZoom = false;\n      ['x', 'y'].forEach((key) => {\n        isZoom = this.zoom[key] && ((this.scale[key] && domain[key]) || (this.scale[`${key}2`] && domain[`${key}2`]));\n      });\n      if (isZoom) {\n        updateZoom.call(this);\n      }\n      if (render) {\n        this.render();\n      }\n    }\n    return this;\n  }\n\n  setTranslate(translate, render) {\n    if (!translate) return this;\n    let isZoom = false;\n    ['x', 'y'].forEach((key) => {\n      if (this.zoom[key]) {\n        this.zoom[key].translate = translate[key];\n        isZoom = true;\n      }\n    });\n    if (isZoom) {\n      this.rendered = false;\n      updateZoom.call(this);\n      if (render) {\n        this.render();\n      }\n    }\n    return this;\n  }\n\n  setPrecision(precision, render) {\n    if (!precision) return this;\n    let isZoom = false;\n    ['x', 'y'].forEach((key) => {\n      if (this.zoom[key]) {\n        this.zoom[key].precision = precision[key];\n        isZoom = true;\n      }\n    });\n    if (isZoom) {\n      this.rendered = false;\n      updateZoom.call(this);\n      if (render) {\n        this.render();\n      }\n    }\n    return this;\n  }\n\n  setLabel(label, render) {\n    if (!label) return this;\n    let isScale = false;\n    axisType.forEach((key) => {\n      if (this.scale[key] && label[key]) {\n        this.scale[key].label = label[key].label;\n        this.scale[key].unit = label[key].unit;\n        isScale = true;\n      }\n    });\n    if (isScale) {\n      this.rendered = false;\n      if (render) {\n        this.render();\n      }\n    }\n    return this;\n  }\n\n  destroy() {\n    this.destroyed = true;\n    this.rendered = false;\n    this.data = null;\n    if (this.zoomer$) {\n      this.zoomer$.on('start', null).on('zoom', null).on('end', null);\n      this.zoomer$ = null;\n    }\n    if (this.zoomSelection$) {\n      this.zoomSelection$\n        .on('click', null)\n        .on('dblclick', null)\n        .on('contextmenu', null)\n        .on('mouseout', null)\n        .on('mousemove', null);\n      this.rootSelection$.select('.xlock').on('click', null);\n      this.rootSelection$.select('.ylock').on('click', null);\n      this.rootSelection$.select('.reset').on('click', null);\n      this.rootSelection$.remove();\n      this.rootSelection$ = null;\n    }\n\n    if (this.actions && this.actions.length) {\n      this.actions.forEach((a, i) => {\n        if (!a) return;\n        const { menus } = a;\n        this.rootSelection$.select(`.action-${i}`).on('click', null);\n        if (Array.isArray(menus)) {\n          menus.forEach((menu, j) => {\n            if (!menu) return;\n            this.rootSelection$.select(`.action-${i}-menu-${j}`).on('click', null);\n          });\n        }\n      });\n      d3.select('body').on('click', null);\n      this.actions = null;\n    }\n    if (this.unBindResize$) {\n      this.unBindResize$();\n      this.unBindResize$ = null;\n    }\n    this.click$ = null;\n    this.dblclick$ = null;\n    this.contextmenu$ = null;\n    this.zoomstart$ = null;\n    this.zooming$ = null;\n    this.zoomend$ = null;\n    this.resize$ = null;\n    this.reset$ = null;\n    this.canZoom$ = null;\n  }\n\n  resize() {\n    if (document.createEvent) {\n      const event = document.createEvent('Event');\n      event.initEvent('resize', true, true);\n      window.dispatchEvent(event);\n    } else if (document.createEventObject) {\n      const event = document.createEventObject();\n      event.type = 'onresize';\n      window.fireEvent('onresize', event);\n    }\n    return this;\n  }\n\n  downloadImage(name, content) {\n    const svgSel = this.rootSelection$.select('svg');\n    const width = +svgSel.attr('width');\n    const height = +svgSel.attr('height');\n    const tempCanvas = document.createElement('canvas');\n    tempCanvas.width = width;\n    tempCanvas.height = height;\n    const tempCxt = tempCanvas.getContext('2d');\n    tempCxt.clearRect(0, 0, width, height);\n    if (content) {\n      tempCxt.drawImage(content.image, content.x, content.y);\n    }\n    const tempImage = new Image();\n    tempImage.src = `data:image/svg+xml;base64,${window.btoa(\n      window.unescape(\n        window.encodeURIComponent(\n          `<?xml version=\"1.0\" standalone=\"no\"?>\n          ${new XMLSerializer().serializeToString(svgSel.node())}`\n        )\n      )\n    )}`;\n    const ext = this.download.ext || 'png';\n    tempImage.onload = () => {\n      tempCxt.drawImage(tempImage, 0, 0);\n      const a = document.createElement('a');\n      a.download = `${name || 'basechart'}.${ext}`;\n      a.href = tempCanvas.toDataURL(`image/${ext}`);\n      a.click();\n    };\n  }\n}\n\nexport default BaseChart;\n"],"file":"index.js"}