{"version":3,"sources":["../../src/util/mixin.js"],"names":["defineProperties","target","source","exclude","Object","getOwnPropertyNames","forEach","key","find","exc","defineProperty","getOwnPropertyDescriptor","setPropertyOf","origClass","copyClass","prototype","setPrototypeOf","subClass","superClass","TypeError","__proto__","Function","mixin","mixins","Mixin","args","M","inherit","inherits","Inherit","I","concat","reduceRight","A","B","replace","newSuperClass","oldSuperClass","getPrototypeOf","revoke"],"mappings":"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","sourcesContent":["/*\n * @Author: Huangjs\n * @Date: 2021-10-11 11:38:34\n * @LastEditors: Huangjs\n * @LastEditTime: 2021-12-08 09:25:05\n * @Description: ******\n */\n\nfunction defineProperties(target, source, exclude = []) {\n  Object.getOwnPropertyNames(source).forEach((key) => {\n    if (!exclude.find((exc) => key === exc)) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    }\n  });\n}\nfunction setPropertyOf(origClass, copyClass) {\n  // 拷贝函数本身（静态）的属性\n  defineProperties(origClass, copyClass, Object.getOwnPropertyNames(origClass));\n  // 拷贝函数prototype（原型）的属性\n  defineProperties(origClass.prototype, copyClass.prototype, Object.getOwnPropertyNames(origClass.prototype));\n}\nfunction setPrototypeOf(subClass, superClass) {\n  if (typeof superClass !== 'function' && superClass !== null) {\n    throw new TypeError(`Super expression must either be a function or null, not ${typeof superClass}`);\n  }\n  // 设置函数自身（静态）的__proto__\n  if (superClass)\n    Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : (subClass.__proto__ = superClass);\n  else\n    Object.setPrototypeOf\n      ? Object.setPrototypeOf(subClass, Function.prototype)\n      : (subClass.__proto__ = Function.prototype);\n  // 设置函数prototype（原型）的__proto__\n  Object.setPrototypeOf\n    ? Object.setPrototypeOf(subClass.prototype, superClass.prototype)\n    : (subClass.prototype.__proto__ = superClass.prototype);\n}\n// 对已定义的类进行按序混合\n// mixins数组后面的属性方法会覆盖前面的同名属性方法\n// mixins数组内应该全是基类，并且不应是null\nfunction mixin(...mixins) {\n  function Mixin(...args) {\n    mixins.forEach((M) => defineProperties(this, new M(...args))); // 拷贝实例属性\n  }\n  mixins.forEach((M) => setPropertyOf(Mixin, M));\n  return Mixin;\n}\n// 对已定义的类进行按序继承\n// inherits数组前面是祖父类后面是子孙类\n// inherits数组内应该全是基类，如果有派生类，则新继承的祖先类需要定义该类使用super的方法\nfunction inherit(...inherits) {\n  function Inherit(...args) {\n    inherits.forEach((I) => defineProperties(this, new I(...args)));\n  }\n  inherits.concat([Inherit]).reduceRight((A, B) => {\n    setPrototypeOf(A, B);\n    return B;\n  });\n  return Inherit;\n}\n// 将原来的subClass父类替换成newSuperClass\n// 注意：subClass必须是派生类（保证构造函数使用super方法）\n// 并且如果subClass的方法里有使用super.xxx()，则替换的newSuperClass或newSuperClass的祖先原型里必须定义xxx方法\nfunction replace(subClass, newSuperClass) {\n  const oldSuperClass = Object.getPrototypeOf ? Object.getPrototypeOf(subClass) : subClass.__proto__;\n  setPrototypeOf(subClass, newSuperClass);\n  return function revoke() {\n    setPrototypeOf(subClass, oldSuperClass);\n  };\n}\nexport default { mixin, inherit, replace };\n"],"file":"mixin.js"}